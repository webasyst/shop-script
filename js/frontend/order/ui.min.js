!function(e){"use strict";var o=function(e){return o=function(e){var o=this;o.$wrapper=e.$wrapper,o.on={ready:"function"==typeof e.ready?e.ready:function(){},change:"function"==typeof e.change?e.change:function(){}},o.active_class=e.active_class||"selected",o.$before=null,o.$active=o.$wrapper.find("> *."+o.active_class),o.initClass()},o.prototype.initClass=function(){function o(o){o.preventDefault();var r=e(this);if(r.hasClass(n))return!1;t.$active.length&&(t.$before=t.$active.removeClass(n)),t.$active=r.addClass(n),t.$wrapper.trigger("change",[this,t]),t.on.change(o,this,t)}var t=this,n=t.active_class;t.$wrapper.on("click","> *",o),t.$wrapper.trigger("ready",t),t.on.ready(t)},o}(e),t=function(e){return t=function(o){var t=this;if(t.$wrapper=o.$wrapper,t.$wrapper&&t.$wrapper.length){t.$block=t.$wrapper.find(".wa-dialog-body");try{t.$body=e(window.top.document).find("body"),t.$window=e(window.top)}catch(o){t.$body=e(document).find("body"),t.$window=e(window)}t.position=o.position||!1,t.userPosition=o.setPosition||!1,t.options=o.options||!1,t.scroll_locked_class="is-scroll-locked",t.height_limit=o.height_limit||640,t.is_visible=!1,t.is_removed=!1,t.onBgClick=o.onBgClick||!1,t.onOpen=o.onOpen||function(){},t.onClose=o.onClose||function(){},t.onResize=o.onResize||!1,t.initClass()}else console.error("Error: bad data for dialog")},t.prototype.initClass=function(){var e=this;e.$wrapper.data("dialog",e),e.render(),setTimeout(function(){e.bindEvents()},0),e.$wrapper.data("dialog",e).trigger("wa_order_dialog_open",[e.$wrapper,e])},t.prototype.bindEvents=function(){function o(){!0===i.close()&&(a.off("click",o),a.off("wa_before_load",o))}function t(){e.contains(document,i.$wrapper[0])?i.resize():(e(window).off("resize",t),a.off("resize",t))}function n(){e.contains(document,i.$wrapper[0])?i.resize():e(document).off("resizeDialog",n)}function r(o){if(i.is_removed)e(document).off("keyup",r);else{switch(o.keyCode){case 27:i.close();break;case 13:var t=i.$wrapper.find(".js-focus-button");1===t.length&&t.trigger("click")}}}var i=this,a=e(document),s=i.$block?i.$block:i.$wrapper;i.$wrapper.on("close",o),i.$wrapper.on("click",".dialog-background",function(e){"function"==typeof i.onBgClick?i.onBgClick(e):e.stopPropagation()}),s.on("click",".js-close-dialog",o),e(window).on("resize",t),a.on("resize",t),a.on("resizeDialog",n),e(document).on("keyup",r)},t.prototype.render=function(){var e=this;try{e.show()}catch(e){console.error("Error: "+e.message),console.log(e.stack)}e.setPosition(),e.$body.addClass(e.scroll_locked_class),e.onOpen(e.$wrapper,e)},t.prototype.setPosition=function(){function e(e){return{left:Math.floor((a-e.width)/2),top:Math.floor((s-e.height)/2)}}var o=this,t=o.$window,n=o.$block,r=n.find(".wa-dialog-content");n.removeClass("is-tall"),n.removeClass("with-tall-content"),r.removeAttr("style");var i,a=t.width(),s=t.height(),c=n.outerWidth(),l=n.outerHeight();if(o.position)i=o.position;else{i=(o.userPosition?o.userPosition:e)({width:c,height:l})}if(i.left>0&&i.left+c>a&&(i.left=a-c-20),i.top>0)l>=o.height_limit&&n.addClass("with-tall-content"),i.top+l>s&&(i.top=s-l-20);else{i.top=20,n.addClass("is-tall"),r.hide();var d=n.outerHeight(),p=s-d-40;r.css({height:p+"px"}).show()}n.css(i)},t.prototype.close=function(){var e=this,o=null;return e.is_visible&&!1!==(o=e.onClose(e))&&(e.$wrapper.remove(),e.is_removed=!0),e.$body.removeClass(e.scroll_locked_class),o},t.prototype.resize=function(){var e=this;e.$block.addClass("is-animated"),e.setPosition(),e.onResize&&e.onResize(e.$wrapper,e)},t.prototype.hide=function(){var o=this;e("<div />").append(o.$wrapper.hide()),o.$body.removeClass(o.scroll_locked_class),o.is_visible=!1},t.prototype.show=function(){var o=this;e.contains(document,o.$wrapper[0])||o.$body.append(o.$wrapper),o.$wrapper.show(),o.is_visible=!0,o.$body.addClass(o.scroll_locked_class),e(window).trigger("scroll")},t.prototype.lock=function(e){var o=this;"boolean"==typeof e&&(e?o.$wrapper.addClass("is-locked"):o.$wrapper.removeClass("is-locked"))},t}(e),n=function(e){function o(e,o){var t={hover:!0,change_selector:"",change_class:"selected",change_title:!0,change_hide:!0};return!1===(void 0!==o.hover?o.hover:e.data("hover"))&&(t.hover=!1),t.change_selector=o.change_selector||e.data("change-selector")||"",t.change_class=o.change_class||e.data("change-class")||"selected",!1===(void 0!==o.change_title?o.change_title:e.data("change-title"))&&(t.change_title=!1),!1===(void 0!==o.change_hide?o.change_hide:e.data("change-hide"))&&(t.change_hide=!1),t}return n=function(e){var t=this;t.$wrapper=e.$wrapper,t.$button=t.$wrapper.find("> .wa-dropdown-toggle"),t.$menu=t.$wrapper.find("> .wa-dropdown-area"),t.on={ready:"function"==typeof e.ready?e.ready:function(){},open:"function"==typeof e.open?e.open:function(){},change:"function"==typeof e.change?e.change:function(){}},t.data=o(t.$wrapper,e),t.is_locked=!1,t.is_opened=!1,t.$before=null,t.$active=null,t.initClass()},n.prototype.initClass=function(){function o(t){if(e.contains(document,n.$wrapper[0])){var r=27===t.keyCode;n.is_opened&&r&&n.hide()}else e(document).off("click",o)}function t(o){var r=n.$wrapper[0];if(e.contains(document,r)){var i=o.target===r||e.contains(r,o.target);n.is_opened&&!i&&n.hide()}else e(document).off("click",t)}var n=this;n.data.hover&&(n.$button.on("mouseenter",function(){n.toggleMenu(!0)}),n.$wrapper.on("mouseleave",function(){n.toggleMenu(!1)})),n.$button.on("click",function(e){e.preventDefault(),n.toggleMenu(!n.is_opened)}),n.data.change_selector&&n.initChange(n.data.change_selector),e(document).on("click",t),e(document).on("keyup",o),n.on.ready(n)},n.prototype.toggleMenu=function(e){var o=this;if(e){if(o.is_locked)return!1;!1!==o.on.open(o)&&o.$wrapper.addClass("is-opened").trigger("open",o)}else o.$wrapper.removeClass("is-opened").trigger("close",o);o.is_opened=e},n.prototype.initChange=function(o){function t(o){o.preventDefault();var t=e(this);n.$active.length&&(n.$before=n.$active.removeClass(r)),n.$active=t.addClass(r),n.data.change_title&&n.setTitle(t.html()),n.data.change_hide&&n.hide(),n.$wrapper.trigger("change",[t[0],n]),n.on.change(o,this,n)}var n=this,r=n.data.change_class;n.$active=n.$menu.find(o+"."+r),n.$wrapper.on("click",o,t)},n.prototype.hide=function(){this.toggleMenu(!1)},n.prototype.setTitle=function(e){this.$button.html(e)},n.prototype.lock=function(e){var o=this;e?(o.$wrapper.addClass("is-locked"),o.is_locked=!0):(o.$wrapper.removeClass("is-locked"),o.is_locked=!1)},n}(e),r=function(o){var t=e.Deferred();return function(o){function t(o){var t=e.Deferred(),n=t.promise(),r=e("#"+o.id);return r.length?n=r.data("promise"):(r=e("<link />",{id:o.id,rel:"stylesheet"}).appendTo("head").data("promise",n),r.on("load",function(){t.resolve(o)}).on("error",function(){t.reject(o)}),r.attr("href",o.uri)),n}function n(o){var t=e.Deferred(),n=t.promise(),r=e("#"+o.id);if(r.length)n=r.data("promise");else{var i=document.createElement("script");document.getElementsByTagName("head")[0].appendChild(i),r=e(i).attr("id",o.id).data("promise",n),r.on("load",function(){t.resolve(o)}).on("error",function(){t.reject(o)}),r.attr("src",o.uri)}return n}function r(e){c-=1,a()}function i(e){l.push(e),c-=1,a()}function a(){0===c&&(l.length?s.reject(l):s.resolve())}var s=e.Deferred(),c=o.length,l=[];return e.each(o,function(e,o){switch(o.type){case"css":t(o).then(r,i);break;case"js":n(o).then(r,i)}}),s.promise()}(o).then(function(){t.resolve()},function(e){console&&console.error&&console.error("Error loading resource",e),t.reject(e)}),t.promise()},i=function(e){var o=!1;return e.length>0&&(e.match(/^[0-9]+(\.+[0-9]+)?$/i)||[]).length>=1&&(o=!0),o},a=function(e){var o=!1;return e.length>0&&(e.match(/^.+@+.+\.+.+$/i)||[]).length>=1&&(o=!0),o},s=function(e){var o=!1;return e.length>0&&(e.match(/^(http:\/\/|https:\/\/)?.+\.+.+$/i)||[]).length>=1&&(o=!0),o},c=function(e){var o=!1;return e.length>0&&(e.match(/^(\+?)+([0-9]|\s|-|\(|\))+$/i)||[]).length>=1&&(o=!0),o},l=null,d=function(e,o){var t=e,n=l;if(!n)return t;try{if((e=parseFloat(e).toFixed(n.fraction_size))>=0&&n){var r=Math.floor(e),i=function(e,o,t){var n="";if(!(o&&e&&t))return e;for(var r=e.split("").reverse(),i=[],a=[],s=0;s<r.length;s++){var c=r[s],l=0===s,d=s===r.length-1;0!==s%o||l||(i.unshift(a),a=[]),a.unshift(c),d&&i.unshift(a)}for(s=0;s<i.length;s++){var p=s===i.length-1;n+=i[s].join("")+(p?"":t)}return n}(""+r,n.group_size,n.group_divider),a=function(e){var o="";if(e>0){e=e.toFixed(n.fraction_size+1),e=Math.round(e*Math.pow(10,n.fraction_size))/Math.pow(10,n.fraction_size);o=e.toFixed(n.fraction_size).replace("0.",n.fraction_divider)}return o}(e-r);t=(o?n.pattern_text:n.pattern_html).replace("%s",i+a)}}catch(o){console&&console.log&&console.log(o.message,e)}return t},p=function(e){e&&(l=e)};window.waOrder=window.waOrder||{},window.waOrder.ui={Toggle:o,Dialog:t,Dropdown:n,validate:{url:s,email:a,phone:c,number:i},load:r,formatPrice:d,initFormatPrice:p},"ontouchstart"in window&&e("html").addClass("is-mobile").addClass("with-touch")}(jQuery);
//# sourceMappingURL=ui.min.js.map
